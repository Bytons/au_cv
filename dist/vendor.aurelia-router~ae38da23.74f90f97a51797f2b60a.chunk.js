(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"4ysu":function(t,e,n){"use strict";(function(t){n.d(e,"c",function(){return C}),n.d(e,"b",function(){return V}),n.d(e,"a",function(){return Q});var r=n("MP1E"),i=n("0esZ"),o=n("3U8n"),a=n("eP1p"),s=n("aurelia-event-aggregator"),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function h(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e||"#"===t[0]||(t="#"+t),e&&n&&(t=t.substring(1,t.length)),t}function l(t,e,n,r){if(v.test(t))return t;var i="";return e.length&&"/"!==e[0]&&(i+="/"),(i+=e).length&&"/"===i[i.length-1]||"/"===t[0]||(i+="/"),i.length&&"/"===i[i.length-1]&&"/"===t[0]&&(i=i.substring(0,i.length-1)),h(i+t,n,r)}function f(t){var e=[];if(Array.isArray(t.route))for(var n=0,r=t.route.length;n<r;++n){var i=Object.assign({},t);i.route=t.route[n],e.push(i)}else e.push(Object.assign({},t));return e}var p=/^#?\//,v=/^([a-z][a-z0-9+\-.]*:)?\/\//i,d=function(){function t(){}return t.prototype.run=function(t,e){return t._commitChanges(!0).then(function(){return t._updateTitle(),e()})},t}(),g=function(){function e(t){this.plan=null,this.options={},Object.assign(this,t),this.params=this.params||{},this.viewPortInstructions={};var e=[],n=this;do{var r=Object.assign({},n.params);n.config&&n.config.hasChildRouter&&delete r[n.getWildCardName()],e.unshift(r),n=n.parentInstruction}while(n);var i=Object.assign.apply(Object,[{},this.queryParams].concat(e));this.lifecycleArgs=[i,this.config,this]}return e.prototype.getAllInstructions=function(){var t=[this];for(var e in this.viewPortInstructions){var n=this.viewPortInstructions[e].childNavigationInstruction;n&&t.push.apply(t,n.getAllInstructions())}return t},e.prototype.getAllPreviousInstructions=function(){return this.getAllInstructions().map(function(t){return t.previousInstruction}).filter(function(t){return t})},e.prototype.addViewPortInstruction=function(t,e,n,r){var i=Object.assign({},this.lifecycleArgs[1],{currentViewPort:t});return this.viewPortInstructions[t]={name:t,strategy:e,moduleId:n,component:r,childRouter:r.childRouter,lifecycleArgs:[].concat(this.lifecycleArgs[0],i,this.lifecycleArgs[2])}},e.prototype.getWildCardName=function(){var t=this.config.route.lastIndexOf("*");return this.config.route.substr(t+1)},e.prototype.getWildcardPath=function(){var t=this.getWildCardName(),e=this.params[t]||"";return this.queryString&&(e+="?"+this.queryString),e},e.prototype.getBaseUrl=function(){var t=this,e=decodeURI(this.fragment);if(""===e){var n=this.router.routes.find(function(e){return e.name===t.config.name&&""!==e.route});n&&(e=n.route)}if(!this.params)return encodeURI(e);var r=this.getWildCardName(),i=this.params[r]||"";return i?encodeURI(e.substr(0,e.lastIndexOf(i))):encodeURI(e)},e.prototype._commitChanges=function(e){var n=this,r=this.router;r.currentInstruction=this,this.previousInstruction&&(this.previousInstruction.config.navModel.isActive=!1),this.config.navModel.isActive=!0,r.refreshNavigation();var i=[],o=[],a=function(t){var a=n.viewPortInstructions[t],s=r.viewPorts[t];if(!s)throw new Error("There was no router-view found in the view for "+a.moduleId+".");a.strategy===R.replace?a.childNavigationInstruction&&a.childNavigationInstruction.parentCatchHandler?i.push(a.childNavigationInstruction._commitChanges(e)):(e&&o.push({viewPort:s,viewPortInstruction:a}),i.push(s.process(a,e).then(function(t){if(a.childNavigationInstruction)return a.childNavigationInstruction._commitChanges(e)}))):a.childNavigationInstruction&&i.push(a.childNavigationInstruction._commitChanges(e))};for(var s in this.viewPortInstructions)a(s);return t.all(i).then(function(){return o.forEach(function(t){return t.viewPort.swap(t.viewPortInstruction)}),null}).then(function(){return(t=n).previousInstruction=null,void(t.plan=null);var t})},e.prototype._updateTitle=function(){var t=this._buildTitle(this.router.titleSeparator);t&&this.router.history.setTitle(t)},e.prototype._buildTitle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" | ",e="",n=[];for(var r in this.config.navModel.title&&(e=this.router.transformTitle(this.config.navModel.title)),this.viewPortInstructions){var i=this.viewPortInstructions[r];if(i.childNavigationInstruction){var o=i.childNavigationInstruction._buildTitle(t);o&&n.push(o)}}return n.length&&(e=n.join(t)+(e?t:"")+e),this.router.title&&(e+=(e?t:"")+this.router.transformTitle(this.router.title)),e},e}();var y=function(){function t(t,e){this.isActive=!1,this.title=null,this.href=null,this.relativeHref=null,this.settings={},this.config=null,this.router=t,this.relativeHref=e}return t.prototype.setTitle=function(t){this.title=t,this.isActive&&this.router.updateTitle()},t}();function m(t){return t&&"function"==typeof t.navigate}var w=function(){function t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=t,this.options=Object.assign({trigger:!0,replace:!0},e),this.shouldContinueProcessing=!1}return t.prototype.setRouter=function(t){this.router=t},t.prototype.navigate=function(t){(this.options.useAppRouter?t:this.router||t).navigate(this.url,this.options)},t}(),b=(function(){function t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.route=t,this.params=e,this.options=Object.assign({trigger:!0,replace:!0},n),this.shouldContinueProcessing=!1}t.prototype.setRouter=function(t){this.router=t},t.prototype.navigate=function(t){(this.options.useAppRouter?t:this.router||t).navigateToRoute(this.route,this.params,this.options)}}(),{completed:"completed",canceled:"canceled",rejected:"rejected",running:"running"}),I=function(){function t(){this.steps=[]}return t.prototype.addStep=function(t){var e=void 0;if("function"==typeof t)e=t;else{if("function"==typeof t.getSteps){for(var n=t.getSteps(),r=0,i=n.length;r<i;r++)this.addStep(n[r]);return this}e=t.run.bind(t)}return this.steps.push(e),this},t.prototype.run=function(t){var e=-1,n=this.steps;function r(){if(!(++e<n.length))return r.complete();var i=n[e];try{return i(t,r)}catch(t){return r.reject(t)}}return r.complete=P(r,b.completed),r.cancel=P(r,b.canceled),r.reject=P(r,b.rejected),r()},t}();function P(e,n){return function(e){return t.resolve({status:n,output:e,completed:n===b.completed})}}var _=function(){function t(){this.instructions=[],this.options={},this.pipelineSteps=[]}return t.prototype.addPipelineStep=function(t,e){if(null==e)throw new Error("Pipeline step cannot be null or undefined.");return this.pipelineSteps.push({name:t,step:e}),this},t.prototype.addAuthorizeStep=function(t){return this.addPipelineStep("authorize",t)},t.prototype.addPreActivateStep=function(t){return this.addPipelineStep("preActivate",t)},t.prototype.addPreRenderStep=function(t){return this.addPipelineStep("preRender",t)},t.prototype.addPostRenderStep=function(t){return this.addPipelineStep("postRender",t)},t.prototype.fallbackRoute=function(t){return this._fallbackRoute=t,this},t.prototype.map=function(t){return Array.isArray(t)?(t.forEach(this.map.bind(this)),this):this.mapRoute(t)},t.prototype.useViewPortDefaults=function(t){return this.viewPortDefaults=t,this},t.prototype.mapRoute=function(t){return this.instructions.push(function(e){for(var n=f(t),r=void 0,i=0,o=n.length;i<o;++i){var a=n[i];a.settings=a.settings||{},r||(r=e.createNavModel(a)),e.addRoute(a,r)}}),this},t.prototype.mapUnknownRoutes=function(t){return this.unknownRouteConfig=t,this},t.prototype.exportToRouter=function(t){for(var e=this.instructions,n=0,r=e.length;n<r;++n)e[n](t);this.title&&(t.title=this.title),this.titleSeparator&&(t.titleSeparator=this.titleSeparator),this.unknownRouteConfig&&t.handleUnknownRoutes(this.unknownRouteConfig),this._fallbackRoute&&(t.fallbackRoute=this._fallbackRoute),this.viewPortDefaults&&t.useViewPortDefaults(this.viewPortDefaults),Object.assign(t.options,this.options);var i=this.pipelineSteps;if(i.length){if(!t.isRoot)throw new Error("Pipeline steps can only be added to the root router");for(var o=t.pipelineProvider,a=0,s=i.length;a<s;++a){var u=i[a],c=u.name,h=u.step;o.addStep(c,h)}}},t}(),R={noChange:"no-change",invokeLifecycle:"invoke-lifecycle",replace:"replace"},N=function(){function t(){}return t.prototype.run=function(t,e){return S(t).then(function(n){return n instanceof w?e.cancel(n):(t.plan=n,e())}).catch(e.cancel)},t}();function S(e,n){var r=e.config;if("redirect"in r){var i=e.router;return i._createNavigationInstruction(r.redirect).then(function(n){var r={};for(var o in n.params){var a=n.params[o];"string"==typeof a&&":"===a[0]?(a=a.slice(1))in e.params&&(r[o]=e.params[a]):r[o]=n.params[o]}var s=i.generate(n.config.name,r,e.options);return e.queryString&&(s+="?"+e.queryString),t.resolve(new w(s))})}var o=e.previousInstruction,a={},s=e.router.viewPortDefaults;if(o){var u=function(t,e){var n=t.params,r=e.params,i=e.config.hasChildRouter?e.getWildCardName():null;for(var o in r)if(o!==i&&n[o]!==r[o])return!0;for(var a in n)if(a!==i&&n[a]!==r[a])return!0;if(!e.options.compareQueryParams)return!1;var s=t.queryParams,u=e.queryParams;for(var c in u)if(s[c]!==u[c])return!0;for(var h in s)if(s[h]!==u[h])return!0;return!1}(o,e),c=[],h=function(i){var h=o.viewPortInstructions[i],l=i in r.viewPorts?r.viewPorts[i]:h;null===l.moduleId&&i in e.router.viewPortDefaults&&(l=s[i]);var f=a[i]={name:i,config:l,prevComponent:h.component,prevModuleId:h.moduleId};if(h.moduleId!==l.moduleId)f.strategy=R.replace;else if("determineActivationStrategy"in h.component.viewModel){var p;f.strategy=(p=h.component.viewModel).determineActivationStrategy.apply(p,e.lifecycleArgs)}else r.activationStrategy?f.strategy=r.activationStrategy:f.strategy=u||n?R.invokeLifecycle:R.noChange;if(f.strategy!==R.replace&&h.childRouter){var v=e.getWildcardPath(),d=h.childRouter._createNavigationInstruction(v,e).then(function(e){return f.childNavigationInstruction=e,S(e,f.strategy===R.invokeLifecycle).then(function(n){if(n instanceof w)return t.reject(n);e.plan=n})});c.push(d)}};for(var l in o.viewPortInstructions)h(l);return t.all(c).then(function(){return a})}for(var l in r.viewPorts){var f=r.viewPorts[l];null===f.moduleId&&l in e.router.viewPortDefaults&&(f=s[l]),a[l]={name:l,strategy:R.replace,config:f}}return t.resolve(a)}var C=function(){function e(t,e){var n=this;this.parent=null,this.options={},this.viewPortDefaults={},this.transformTitle=function(t){return n.parent?n.parent.transformTitle(t):t},this.container=t,this.history=e,this.reset()}return e.prototype.reset=function(){var e=this;this.viewPorts={},this.routes=[],this.baseUrl="",this.isConfigured=!1,this.isNavigating=!1,this.isExplicitNavigation=!1,this.isExplicitNavigationBack=!1,this.isNavigatingFirst=!1,this.isNavigatingNew=!1,this.isNavigatingRefresh=!1,this.isNavigatingForward=!1,this.isNavigatingBack=!1,this.couldDeactivate=!1,this.navigation=[],this.currentInstruction=null,this.viewPortDefaults={},this._fallbackOrder=100,this._recognizer=new i.a,this._childRecognizer=new i.a,this._configuredPromise=new t(function(t){e._resolveConfiguredPromise=t})},e.prototype.registerViewPort=function(t,e){e=e||"default",this.viewPorts[e]=t},e.prototype.ensureConfigured=function(){return this._configuredPromise},e.prototype.configure=function(e){var n=this;this.isConfigured=!0;var r=e,i=void 0;return"function"==typeof e&&(r=e(i=new _)),t.resolve(r).then(function(t){t&&t.exportToRouter&&(i=t),i.exportToRouter(n),n.isConfigured=!0,n._resolveConfiguredPromise()})},e.prototype.navigate=function(t,e){return!this.isConfigured&&this.parent?this.parent.navigate(t,e):(this.isExplicitNavigation=!0,this.history.navigate(function(t,e,n){return p.test(t)?h(t,n):l(t,e,n)}(t,this.baseUrl,this.history._hasPushState),e))},e.prototype.navigateToRoute=function(t,e,n){var r=this.generate(t,e);return this.navigate(r,n)},e.prototype.navigateBack=function(){this.isExplicitNavigationBack=!0,this.history.navigateBack()},e.prototype.createChild=function(t){var n=new e(t||this.container.createChild(),this.history);return n.parent=this,n},e.prototype.generate=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._recognizer.hasRoute(t);if((!this.isConfigured||!r)&&this.parent)return this.parent.generate(t,e,n);if(!r)throw new Error("A route with name '"+t+"' could not be found. Check that `name: '"+t+"'` was specified in the route's config.");var i=l(this._recognizer.generate(t,e),this.baseUrl,this.history._hasPushState,n.absolute);return n.absolute?""+this.history.getAbsoluteRoot()+i:i},e.prototype.createNavModel=function(t){var e=new y(this,"href"in t?t.href:t.route);return e.title=t.title,e.order=t.nav,e.href=t.href,e.settings=t.settings,e.config=t,e},e.prototype.addRoute=function(t,e){if(Array.isArray(t.route)){f(t).forEach(this.addRoute.bind(this))}else{k(t,this.routes),"viewPorts"in t||t.navigationStrategy||(t.viewPorts={default:{moduleId:t.moduleId,view:t.view}}),e||(e=this.createNavModel(t)),this.routes.push(t);var n=t.route;"/"===n.charAt(0)&&(n=n.substr(1));var r=!0===t.caseSensitive,i=this._recognizer.add({path:n,handler:t,caseSensitive:r});if(n){var o=t.settings;delete t.settings;var a=JSON.parse(JSON.stringify(t));t.settings=o,a.route=n+"/*childRoute",a.hasChildRouter=!0,this._childRecognizer.add({path:a.route,handler:a,caseSensitive:r}),a.navModel=e,a.settings=t.settings,a.navigationStrategy=t.navigationStrategy}if(t.navModel=e,(e.order||0===e.order)&&-1===this.navigation.indexOf(e)){if(!e.href&&""!==e.href&&(i.types.dynamics||i.types.stars))throw new Error('Invalid route config for "'+t.route+'" : dynamic routes must specify an "href:" to be included in the navigation model.');"number"!=typeof e.order&&(e.order=++this._fallbackOrder),this.navigation.push(e),this.navigation=this.navigation.sort(function(t,e){return t.order-e.order})}}},e.prototype.hasRoute=function(t){return!!(this._recognizer.hasRoute(t)||this.parent&&this.parent.hasRoute(t))},e.prototype.hasOwnRoute=function(t){return this._recognizer.hasRoute(t)},e.prototype.handleUnknownRoutes=function(t){var e=this;if(!t)throw new Error("Invalid unknown route handler");this.catchAllHandler=function(n){return e._createRouteConfig(t,n).then(function(t){return n.config=t,n})}},e.prototype.updateTitle=function(){if(this.parent)return this.parent.updateTitle();this.currentInstruction&&this.currentInstruction._updateTitle()},e.prototype.refreshNavigation=function(){for(var t=this.navigation,e=0,n=t.length;e<n;e++){var r=t[e];r.config.href?r.href=h(r.config.href,this.history._hasPushState):r.href=l(r.relativeHref,this.baseUrl,this.history._hasPushState)}},e.prototype.useViewPortDefaults=function(t){for(var e in t){var n=t[e];this.viewPortDefaults[e]={moduleId:n.moduleId}}},e.prototype._refreshBaseUrl=function(){this.parent&&(this.baseUrl=A(this.parent,this.parent.currentInstruction))},e.prototype._createNavigationInstruction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e,i="",o=e.indexOf("?");-1!==o&&(r=e.substr(0,o),i=e.substr(o+1));var a=this._recognizer.recognize(e);a&&a.length||(a=this._childRecognizer.recognize(e));var s={fragment:r,queryString:i,config:null,parentInstruction:n,previousInstruction:this.currentInstruction,router:this,options:{compareQueryParams:this.options.compareQueryParams}},u=void 0;if(a&&a.length){var c=a[0],h=new g(Object.assign({},s,{params:c.params,queryParams:c.queryParams||a.queryParams,config:c.config||c.handler}));u="function"==typeof c.handler?j(h,c.handler,c):c.handler&&"function"==typeof c.handler.navigationStrategy?j(h,c.handler.navigationStrategy,c.handler):t.resolve(h)}else if(this.catchAllHandler){u=j(new g(Object.assign({},s,{params:{path:r},queryParams:a?a.queryParams:{},config:null})),this.catchAllHandler)}else if(this.parent){var l=this._parentCatchAllHandler(this.parent);if(l){var f=this._findParentInstructionFromRouter(l,n);u=j(new g(Object.assign({},s,{params:{path:r},queryParams:a?a.queryParams:{},router:l,parentInstruction:f,parentCatchHandler:!0,config:null})),l.catchAllHandler)}}return u&&n&&(this.baseUrl=A(this.parent,n)),u||t.reject(new Error("Route not found: "+e))},e.prototype._findParentInstructionFromRouter=function(t,e){return e.router===t?(e.fragment=t.baseUrl,e):e.parentInstruction?this._findParentInstructionFromRouter(t,e.parentInstruction):void 0},e.prototype._parentCatchAllHandler=function(t){return t.catchAllHandler?t:!!t.parent&&this._parentCatchAllHandler(t.parent)},e.prototype._createRouteConfig=function(e,n){var r=this;return t.resolve(e).then(function(t){return"string"==typeof t?{moduleId:t}:"function"==typeof t?t(n):t}).then(function(t){return"string"==typeof t?{moduleId:t}:t}).then(function(t){return t.route=n.params.path,k(t,r.routes),t.navModel||(t.navModel=r.createNavModel(t)),t})},c(e,[{key:"isRoot",get:function(){return!this.parent}}]),e}();function A(t,e){return""+(t.baseUrl||"")+(e.getBaseUrl()||"")}function k(t,e){if("object"!==(void 0===t?"undefined":u(t)))throw new Error("Invalid Route Config");if("string"!=typeof t.route){var n=t.name||"(no name)";throw new Error('Invalid Route Config for "'+n+'": You must specify a "route:" pattern.')}if(!("redirect"in t||t.moduleId||t.navigationStrategy||t.viewPorts))throw new Error('Invalid Route Config for "'+t.route+'": You must specify a "moduleId:", "redirect:", "navigationStrategy:", or "viewPorts:".')}function j(e,n,r){return t.resolve(n.call(r,e)).then(function(){return"viewPorts"in e.config||(e.config.viewPorts={default:{moduleId:e.config.moduleId}}),e})}var E=function(){function t(){}return t.prototype.run=function(t,e){return T(t,"canDeactivate",e)},t}(),M=function(){function t(){}return t.prototype.run=function(t,e){return U(t,"canActivate",e)},t}(),O=function(){function t(){}return t.prototype.run=function(t,e){return T(t,"deactivate",e,!0)},t}(),q=function(){function t(){}return t.prototype.run=function(t,e){return U(t,"activate",e,!0)},t}();function T(t,e,n,r){var i=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var i in e){var o=e[i],a=o.prevComponent;if((o.strategy===R.invokeLifecycle||o.strategy===R.replace)&&a){var s=a.viewModel;n in s&&r.push(s)}o.strategy===R.replace&&a?x(a,n,r):o.childNavigationInstruction&&t(o.childNavigationInstruction.plan,n,r)}return r}(t.plan,e),o=i.length;function a(t){return r||z(t)?s():n.cancel(t)}function s(){if(o--)try{return H(i[o][e](t),a,n.cancel)}catch(t){return n.cancel(t)}return t.router.couldDeactivate=!0,n()}return s()}function x(t,e,n){var r=t.childRouter;if(r&&r.currentInstruction){var i=r.currentInstruction.viewPortInstructions;for(var o in i){var a=i[o].component,s=a.viewModel;e in s&&n.push(s),x(a,e,n)}}}function U(t,e,n,r){var i=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];var i=arguments[3];var o=e.plan;Object.keys(o).filter(function(a){var s=o[a],u=e.viewPortInstructions[a],c=u.component.viewModel;(s.strategy===R.invokeLifecycle||s.strategy===R.replace)&&n in c&&r.push({viewModel:c,lifecycleArgs:u.lifecycleArgs,router:i}),s.childNavigationInstruction&&t(s.childNavigationInstruction,n,r,u.component.childRouter||i)});return r}(t,e),o=i.length,a=-1;function s(){if(++a<o)try{var t,u=i[a];return H((t=u.viewModel)[e].apply(t,u.lifecycleArgs),function(t){return function(t,e){return r||z(t,e)?s():n.cancel(t)}(t,u.router)},n.cancel)}catch(t){return n.cancel(t)}return n()}return s()}function z(t,e){return!(t instanceof Error)&&(m(t)?("function"==typeof t.setRouter&&t.setRouter(e),!!t.shouldContinueProcessing):void 0===t||t)}var D=function(){function t(t){this._subscribed=!0,this._subscription=t(this),this._subscribed||this.unsubscribe()}return t.prototype.unsubscribe=function(){this._subscribed&&this._subscription&&this._subscription.unsubscribe(),this._subscribed=!1},c(t,[{key:"subscribed",get:function(){return this._subscribed}}]),t}();function H(e,n,r){if(e&&"function"==typeof e.then)return t.resolve(e).then(n).catch(r);if(e&&"function"==typeof e.subscribe){var i=e;return new D(function(t){return i.subscribe({next:function(){t.subscribed&&(t.unsubscribe(),n(e))},error:function(e){t.subscribed&&(t.unsubscribe(),r(e))},complete:function(){t.subscribed&&(t.unsubscribe(),n(e))}})})}try{return n(e)}catch(t){return r(t)}}var V=function(){function t(){}return t.prototype.loadRoute=function(t,e,n){throw Error('Route loaders must implement "loadRoute(router, config, navigationInstruction)".')},t}(),B=function(){function t(t){this.routeLoader=t}return t.inject=function(){return[V]},t.prototype.run=function(t,e){return L(this.routeLoader,t).then(e).catch(e.cancel)},t}();function L(e,n){var r=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var r=e.plan;for(var i in r){var o=r[i];if(o.strategy===R.replace)n.push({viewPortPlan:o,navigationInstruction:e}),o.childNavigationInstruction&&t(o.childNavigationInstruction,n);else{var a=e.addViewPortInstruction(i,o.strategy,o.prevModuleId,o.prevComponent);o.childNavigationInstruction&&(a.childNavigationInstruction=o.childNavigationInstruction,t(o.childNavigationInstruction,n))}}return n}(n).map(function(n){return function(e,n,r){var i=r.config?r.config.moduleId:null;return function(t,e,n){var r=e.router,i=e.lifecycleArgs;return t.loadRoute(r,n,e).then(function(t){var e=t.viewModel,o=t.childContainer;if(t.router=r,t.config=n,"configureRouter"in e){var a=o.getChildRouter();return t.childRouter=a,a.configure(function(t){return e.configureRouter.apply(e,[t,a].concat(i))}).then(function(){return t})}return t})}(e,n,r.config).then(function(o){var a=n.addViewPortInstruction(r.name,r.strategy,i,o),s=o.childRouter;if(s){var u=n.getWildcardPath();return s._createNavigationInstruction(u,n).then(function(n){return r.childNavigationInstruction=n,S(n).then(function(r){return r instanceof w?t.reject(r):(n.plan=r,a.childNavigationInstruction=n,L(e,n))})})}})}(e,n.navigationInstruction,n.viewPortPlan)});return t.all(r)}var F=function(){function t(t,e,n){this.steps=[],this.container=t,this.slotName=e,this.slotAlias=n}return t.prototype.getSteps=function(){var t=this;return this.steps.map(function(e){return t.container.get(e)})},t}(),W=function(){function t(t){this.container=t,this.steps=[N,E,B,this._createPipelineSlot("authorize"),M,this._createPipelineSlot("preActivate","modelbind"),O,q,this._createPipelineSlot("preRender","precommit"),d,this._createPipelineSlot("postRender","postcomplete")]}return t.inject=function(){return[o.a]},t.prototype.createPipeline=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=new I;return this.steps.forEach(function(r){(e||r!==E)&&n.addStep(t.container.get(r))}),n},t.prototype._findStep=function(t){return this.steps.find(function(e){return e.slotName===t||e.slotAlias===t})},t.prototype.addStep=function(t,e){var n=this._findStep(t);if(!n)throw new Error("Invalid pipeline slot name: "+t+".");n.steps.includes(e)||n.steps.push(e)},t.prototype.removeStep=function(t,e){var n=this._findStep(t);n&&n.steps.splice(n.steps.indexOf(e),1)},t.prototype._clearSteps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this._findStep(t);e&&(e.steps=[])},t.prototype.reset=function(){this._clearSteps("authorize"),this._clearSteps("preActivate"),this._clearSteps("preRender"),this._clearSteps("postRender")},t.prototype._createPipelineSlot=function(t,e){return new F(this.container,t,e)},t}(),J=r.getLogger("app-router"),Q=function(e){function n(t,n,r,i){var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this,t,n));return o.pipelineProvider=r,o.events=i,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.inject=function(){return[o.a,a.a,W,s.a]},n.prototype.reset=function(){e.prototype.reset.call(this),this.maxInstructionCount=10,this._queue?this._queue.length=0:this._queue=[]},n.prototype.loadUrl=function(t){var e=this;return this._createNavigationInstruction(t).then(function(t){return e._queueInstruction(t)}).catch(function(t){J.error(t),Y(e)})},n.prototype.registerViewPort=function(n,r){var i=this;if(e.prototype.registerViewPort.call(this,n,r),this.isActive)this._dequeueInstruction();else{var o=this._findViewModel(n);if("configureRouter"in o){if(!this.isConfigured){var a=this._resolveConfiguredPromise;return this._resolveConfiguredPromise=function(){},this.configure(function(t){return o.configureRouter(t,i)}).then(function(){i.activate(),a()})}}else this.activate()}return t.resolve()},n.prototype.activate=function(t){this.isActive||(this.isActive=!0,this.options=Object.assign({routeHandler:this.loadUrl.bind(this)},this.options,t),this.history.activate(this.options),this._dequeueInstruction())},n.prototype.deactivate=function(){this.isActive=!1,this.history.deactivate()},n.prototype._queueInstruction=function(e){var n=this;return new t(function(t){e.resolve=t,n._queue.unshift(e),n._dequeueInstruction()})},n.prototype._dequeueInstruction=function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.resolve().then(function(){if(!e.isNavigating||n){var r=e._queue.shift();if(e._queue.length=0,r){e.isNavigating=!0;var i=e.history.getState("NavigationTracker");if(i||e.currentNavigationTracker?i?e.currentNavigationTracker?e.currentNavigationTracker<i?e.isNavigatingForward=!0:e.currentNavigationTracker>i&&(e.isNavigatingBack=!0):e.isNavigatingRefresh=!0:e.isNavigatingNew=!0:(e.isNavigatingFirst=!0,e.isNavigatingNew=!0),i||(i=Date.now(),e.history.setState("NavigationTracker",i)),e.currentNavigationTracker=i,r.previousInstruction=e.currentInstruction,n){if(n===e.maxInstructionCount-1)return J.error(n+1+" navigation instructions have been attempted without success. Restoring last known good location."),Y(e),e._dequeueInstruction(n+1);if(n>e.maxInstructionCount)throw new Error("Maximum navigation attempts exceeded. Giving up.")}else e.events.publish("router:navigation:processing",{instruction:r});return e.pipelineProvider.createPipeline(!e.couldDeactivate).run(r).then(function(r){return function(e,n,r,i){n&&"completed"in n&&"output"in n||((n=n||{}).output=new Error("Expected router pipeline to return a navigation result, but got ["+JSON.stringify(n)+"] instead."));var o=null,a=null;m(n.output)?a=n.output.navigate(i):(o=n,n.completed||(n.output instanceof Error&&J.error(n.output),Y(i)));return t.resolve(a).then(function(t){return i._dequeueInstruction(r+1)}).then(function(t){return o||t||n})}(0,r,n,e)}).catch(function(t){return{output:t instanceof Error?t:new Error(t)}}).then(function(t){return function(t,e,n,r){t.resolve(e);var i={instruction:t,result:e};if(n)r.events.publish("router:navigation:child:complete",i);else{r.isNavigating=!1,r.isExplicitNavigation=!1,r.isExplicitNavigationBack=!1,r.isNavigatingFirst=!1,r.isNavigatingNew=!1,r.isNavigatingRefresh=!1,r.isNavigatingForward=!1,r.isNavigatingBack=!1,r.couldDeactivate=!1;var o=void 0;if(e.output instanceof Error)o="error";else if(e.completed){var a=t.queryString?"?"+t.queryString:"";r.history.previousLocation=t.fragment+a,o="success"}else o="canceled";r.events.publish("router:navigation:"+o,i),r.events.publish("router:navigation:complete",i)}return e}(r,t,!!n,e)})}}})},n.prototype._findViewModel=function(t){if(this.container.viewModel)return this.container.viewModel;if(t.container)for(var e=t.container;e;){if(e.viewModel)return this.container.viewModel=e.viewModel,e.viewModel;e=e.parent}},n}(C);function Y(t){t.history.previousLocation?t.navigate(t.history.previousLocation,{trigger:!1,replace:!0}):t.fallbackRoute?t.navigate(t.fallbackRoute,{trigger:!0,replace:!0}):J.error("Router navigation failed, and no previous location or fallbackRoute could be restored.")}}).call(this,n("25Wt"))}}]);
//# sourceMappingURL=vendor.aurelia-router~ae38da23.74f90f97a51797f2b60a.bundle.map